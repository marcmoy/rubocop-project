# Rubocop Adjustments

[FLAG] = needs to be discussed or reviewed

## Metrics/LineLength
#### Observations:
The max line length defined by `ThoughBot` is 80. Currently, the App Academy curriculum failed this cop `5078` times.
Using `$ rubocop --only Metrics/LineLength --format worst` would generate a list of files sorted by how many times it offended the `Metrics/LineLength` cop from highest to lowest. These were the top 3 results:

```
1845  sql/projects/movie_buff/skeleton/db/data/movies.rb
1845  sql/projects/movie_buff/solution/db/data/movies.rb
21    sql/projects/movie_buff/skeleton/spec/movie_buff_queries_spec.rb
```
The two `db/data/movies.rb` files are clearly causing abnormal results for the `Metrics/LineLength` offense count.

Another pattern that also occurred was that `config/`, `bin/spring`, `Gemfile`, and `Rakefile` files were repeatedly appearing which are automatically generated by Rails.

#### Decision:
This cop will be modified to exclude extraneous files and certain files that Rails automatically generates for the development of this linter.
```
Metrics/LineLength:
  Exclude:
    - '**/db/data/movies.rb'
    - '**/config/*.rb'
    - '**/config/environments/*.rb'
    - '**/config/initializers/*.rb'
    - '**/config/production/*.rb'
    - '**/bin/spring'
    - '**/Gemfile'
    - '**/Rakefile'
```

## Style/StringLiterals
#### Observations:
The current `ThoughBot` settings yields `3653` offenses. When turning off the `EnforcedStyle: double_quotes` in the existing `ThoughBot` settings, this yielded `25080` offenses. The main question that needs to be answered for this cop is **single or double quotes?**. [FLAG]

#### Decision:
This cop will remain unchanged for now. Once a decision for this cop is made, the following `rubocop` command could autocorrect all of the instances where this offense occurs in the existing code base:
```
$ rubocop --only Style/StringLiterals -a
```
**Disclaimer:** The Rubocop Documentation advises to use this autocorrector tool ***with caution***. Given that this cop would convert single quotes to double quotes, no serious issues should not arise if proceeded using it. However, further discussion with App Academy staff should be require before using this tool.

## Style/SpaceAroundOperators
#### Observations:
The rule ensures that only a single space is separated between each operator. For example,
```ruby
x=1+1 # bad
x = 1 + 1 # good
```
After running `rubocop --only Style/SpaceAroundOperators --format worst`, this cop affected `17` files. These were the top `5` affected files:
```
744   react/projects/pokedex/skeleton/db/seeds.rb
744   react/projects/pokedex/solution/db/seeds.rb
450   sql/projects/movie_buff/skeleton/spec/movie_buff_queries_spec.rb
450   sql/projects/movie_buff/solution/spec/movie_buff_queries_spec.rb
4     ruby/projects/test_first_ruby/solution/spec/12_rpn_calculator_spec.rb
```
#### Decision:
This cop will remain enabled. Considering the small amount of files this cop affects and that the correction is not too destructive, it should be safe to use the `rubocop` autocorrector tool for this rule.

## Style/SpaceInsideHashLiteralBraces
#### Observations:
The rule ensures that only a single space exists inside hash braces. For example,
```ruby
a = {a: "a", b: "b"} # bad
a = { a: "a", b: "b" } # good
```
This cop affects `41` files.

#### Decision:
This cop will remain enabled. Considering the small amount of files this cop affects and that the correction is not too destructive, it should be safe to use the `rubocop` autocorrector tool for this rule.

## Style/Documentation
#### Observations:
This rule is stupid and should not apply to App Academy.

#### Decision:
This cop will be disabled.

## Style/Tab
#### Observations:
This rule ensures at least 2 spaces are used for tabs. When tested against the curriculum, `22` files were affected. When testing the autocorrect tool on the `react/projects/bench_bnb/solution/app/models/user.rb` file, it seemed to work perfectly fine.

#### Decision:
This cop will remain enabled. Considering the small amount of files this cop affects and that the correction is not too destructive, it should be safe to use the `rubocop` autocorrector tool for this rule.

## Style/HashSyntax
#### Observations:
This rule ensures the new Ruby hash syntax is used. For example,
```ruby
{ :a => 3, :b => 4 } #bad
{ a: 3, b: 4 } #good
```
This cop affects more than `50` files.

#### Decision:
This cop will remain enabled. Although this cop affects numerous files, it should be safe to use the automated `rubocop` autocorrector tool for this correction, since the adjustment is not too destructive.

## Style/TrailingCommaInLiteral / Style/TrailingCommaInArguments
#### Observations:
The existing `ThoughBot` settings use the following option for this cop:
```
  EnforcedStyleForMultiline: comma
```
The [Rubocop documentation](http://www.rubydoc.info/gems/rubocop/RuboCop/Cop/Style/TrailingCommaInLiteral) does a good job explaining this rule and the how to configure of this cop.

These cops affect more than `50` files.

#### Decision:
This cop will be disabled for now. This cop can be modified with the following option to prevent warnings for missing comma at last argument:
```
  EnforcedStyleForMultiline: no_comma
```
However, adding this option will create warnings for `Avoid comma after the last item of a hash/argument.` [FLAG]

## Style/TrailingWhitespace
#### Observations:
Atom can automatically remove trailing white spaces if they occur, but not everyone has it on by default. The use of this cop is debatable.

This cop affects more than `50` files.

#### Decision:
This cop will be disabled, but the autocorrector tool can be used to eliminate all the existing trailing white spaces in the code base if neeeded.

## Style/IndentArray
#### Observations:
If this rule was **enabled**, the following code **will** give a warning:
```ruby
expect(my_transpose(matrix)).to eq([
  [1, 4, 7],
  [2, 5, 8],
  [3, 6, 9]
])
```
And this **will not** give a warning:
```ruby
expect(my_transpose(matrix)).to eq([
                                    [1, 4, 7],
                                    [2, 5, 8],
                                    [3, 6, 9]
                                  ])
```

#### Decision:
This cop will be disabled.

## Style/RedundantSelf
#### Observations:
If this rule was **enabled**, the following code **will** give a warning:
```ruby
class Array
  def my_each(&prc)
    self.length.times do |i| # self.length is NOT okay
      prc.call(self[i])
    end

    self
  end
end
```
And this **will not** give a warning:
```ruby
class Array
  def my_each(&prc)
    length.times do |i| # prefer to use length without self
      prc.call(self[i])  
    end

    self
  end
end
```
#### Decision:
This cop will be disabled.

## Style/SpaceInsideBlockBraces
#### Observations:
This rule ensures a single space exists inside block braces. For example,
```ruby
{a: 3, b: 4} #bad
{ a: 3, b: 4 } #good
```
This cop affects `23` files.

#### Decision:
This cop will remain enabled. Considering the small amount of files this cop affects and that the correction is not too destructive, it should be safe to use the `rubocop` autocorrector tool for this rule.

## Style/EmptyLines
#### Decision:
This cop will be disabled until number of detected empty lines can be configured. [FLAG]

## Style/EmptyLinesAround...Body
#### Observations:
There are 4 similar versions of this cop:
- `EmptyLinesAroundMethodBody`
- `EmptyLinesAroundModuleBody`
- `EmptyLinesAroundBlockBody`
- `EmptyLinesAroundClassBody`

#### Decision:
These cops will be disabled until number of detected empty lines can be configured. [FLAG]

## Style/EmptyLinesAroundAccessModifier
#### Observations:
This cop ensures there are single empty lines that exists before and after `private`.

This cop affects more than `50` files.

#### Decision:
This cop will remain enabled. Although this cop affects numerous files, it should be safe to use the automated `rubocop` autocorrector tool correction is not too destructive. will make.

## Style/BracesAroundHashParameters
#### Observations:
This cop gives a warning when there are redundant curly braces around a hash parameter. For example,
```ruby
set.insert({ a: 3, b: 4 }) # bad
set.insert(a: 3, b: 4) # good
```
This cop affects `28` files.

#### Decision:
This cop will remain enabled. Considering the small amount of files this cop affects and that the correction is not too destructive, it should be safe to use the `rubocop` autocorrector tool for this rule.

## Style/ExtraSpacing
#### Observations:
This cop gives a warning if there are extra unnecessary spaces.

This cop affects more than `50` files.

#### Decision:
This cop will remain enabled. Although this cop affects numerous files, it should be safe to use the automated `rubocop` autocorrector tool for this correction, since the adjustment is not too destructive.

## Style/ClassAndModuleChildren
#### Observations:
This cop is too advanced for people learning Ruby.

#### Decision:
This cop will be disabled.

## Style/DotPosition
#### Observations:
If this rule was **enabled**, the following code **will** give a warning:
```ruby
Poll.joins(questions: :answer_choices)
    .joins(joins_sql)
    .group("polls.id")
```
And this **will not** give a warning:
```ruby
Poll.joins(questions: :answer_choices).joins(joins_sql).group("polls.id")
```
#### Decision:
This cop will be disabled.

## Style/TrailingBlankLines
#### Observations:
This cop ensures **at least** one empty blank line exists at the end of file.

#### Decision:
This cop will be disabled.

## Style/MultilineMethodCallBraceLayout
#### Observations:
The [docs](http://www.rubydoc.info/gems/rubocop/RuboCop/Cop/Style/MultilineMethodCallBraceLayout) do a good job explaining this rule.
This cop affects `6` files.

#### Decision:
This cop will be disabled for now. This topic needs to be discussed and studied more closely.[FLAG]

## Style/FirstParameterIndentation
#### Observations:
If this rule was **enabled**, the following code **will** give a warning:
```ruby
todo0 = Todo.create(
          title: "Pass all the assessments",
          body: "I am capable of crushing every assessment if I study enough",
          done: false )
```
And this **will not** give a warning:
```ruby
todo0 = Todo.create(
  title: "Pass all the assessments",
  body: "I am capable of crushing every assessment if I study enough",
  done: false )
```
This cop affects `11` files.

#### Decision:
This cop will be disabled.

## Style/SpaceBeforeBlockBraces
#### Observations:
This cop gives a warning when there is a space missing to the left of `{`. For example,
```ruby
node = possible_moves.find{ |child| child.winning_node?(mark) } # bad
node = possible_moves.find { |child| child.winning_node?(mark) } # good
```
This cop affects `11` files and is mostly raised in `**_spec.rb` files.

#### Decision:
This cop will remain enabled. Considering the small amount of files this cop affects and that the correction is not too destructive, it should be safe to use the `rubocop` autocorrector tool for this rule.

## Style/SymbolProc
#### Observations:
This cop encourages to pass `&:method` as an argument. For example,
```ruby
question_ids = questions.map { |question| question.id } # okay
question_ids = questions.map(&:id) # better
```
#### Decision:
This cop will remain enabled. Although this cop affects numerous files, it should be safe to use the automated `rubocop` autocorrector tool for this correction, since the adjustment is not too destructive.

## Style/LeadingCommentSpace
#### Observations:
This cop ensures a space after # for comments.

#### Decision:
This cop will be disabled.

## Style/ParallelAssignment
#### Observations:
This cop prevents the use of parallel assignment. For example,
```ruby
# bad
x, y = 0, 1
# good
x = 0
y = 1
```

#### Decision:
This cop will be disabled.

## Style/MutableConstant
#### Observations:
The [docs](http://www.rubydoc.info/gems/rubocop/RuboCop/Cop/Style/MutableConstant) do a good job explaining this rule.
```ruby
# bad
CONST = [1, 2, 3]
# good
CONST = [1, 2, 3].freeze
```

#### Decision:
This cop will remain enabled. Although this cop affects numerous files, it should be safe to use the automated `rubocop` autocorrector tool for this correction, since the adjustment is not too destructive.

## Style/SpaceAfterComma
#### Observations:
```ruby
# bad
run_times = [8,6,5,7]
# good
run_times = [8, 6, 5, 7]
```

#### Decision:
This cop will remain enabled. Considering the small amount of files this cop affects and that the correction is not too destructive, it should be safe to use the `rubocop` autocorrector tool for this rule.

## Style/AlignHash
#### Observations:
If this rule was **enabled**, the following code **will** give a warning:
```ruby
# rails/projects/reddit_on_rails/solution/app/models/concerns/votable.rb
has_many :user_votes, as: :votable,
  class_name: "UserVote",
  dependent: :destroy
# rails/demos/rspec_capybara_testing_demo/spec/models/basketball_team_spec.rb
cavs = BasketballTeam.create!(name: "Cavaliers",
                               city: "Cleveland")
```
And this **will not** give a warning:
```ruby
# rails/projects/reddit_on_rails/solution/app/models/concerns/votable.rb
has_many :user_votes, as: :votable,
                      class_name: "UserVote",
                      dependent: :destroy
# rails/demos/rspec_capybara_testing_demo/spec/models/basketball_team_spec.rb
cavs = BasketballTeam.create!(name: "Cavaliers",
                              city: "Cleveland")
```
This cop affects `10` files.

#### Decision:
This cop will remain enabled. Considering the small amount of files this cop affects and that the correction is not too destructive, it should be safe to use the `rubocop` autocorrector tool for this rule.

## Style/CollectionMethods
#### Observations:
ThoughBot style guide prefers the following collection methods:
```yml
Style/CollectionMethods:
  Enabled: true
  PreferredMethods:
    find: detect
    inject: reduce
    collect: map
    find_all: select
```
This cop affects `17` files.

#### Decision:
This cop will be disabled. Students and TA's should not be restricted to which method they choose to use.

## Style/NumericPredicate
#### Observations:
This rule encourages the use of `#zero?` method. For example,
```ruby
# bad
x == 0
# good
x.zero?
```

#### Decision:
This cop will be disabled.

## Style/BlockDelimiters
#### Observations:
This rule encourages the use of `do..end` for multiline blocks and `{...}` for single-line blocks.

There were only `20` offenses for this cop and each of the affected files were `_spec.rb` files.

When testing how the `rubocop` autocorrector would respond to these offenses, there were `4` offenses that could not corrected. Each of those offenses share a similar case:
```ruby
# ruby/projects/reversi/solution/spec/piece_spec.rb

# This line gives a warning because of single-line "do..end" block.
it "sets board" do; expect(piece.board).to eq(board); end

# This line throws an error when spec is ran.
it "sets board" { expect(piece.board).to eq(board) }

# This is how the line should be written to pass the rubocop.
# This correction needs to be manually changed for those 4 offenses.
it "sets board" do
  expect(piece.board).to eq(board)
end
```

#### Decision:
This cop will remain enabled and those four remaining offenses can easily be changed manually.

## Style/SpaceInsideBrackets
#### Observations:
This cop discourages extra spaces inside brackets. For example,
```ruby
# ruby/projects/reversi/solution/lib/piece.rb

# bad
  DELTAS = [
    [-1, -1],
    [-1,  0],
    [-1,  1],
    [ 0, -1],
    [ 0,  1],
    [ 1, -1],
    [ 1,  0],
    [ 1,  1]
  ]
# good
  DELTAS = [
    [-1, -1],
    [-1,  0],
    [-1,  1],
    [0, -1],
    [0,  1],
    [1, -1],
    [1,  0],
    [1,  1]
  ]
```
This cop affects `5` files.

#### Decision
This cop will be disabled since there are a small amount of affected files and some code in the curriculum is more readable with the extra space.

## Style/SpaceInsideParens
#### Observations:
This cop discourages extra spaces at the beginning or end inside parenthesis. For example,
```ruby
x = plus( 1, 2 ) # bad
x = plus(1, 2) # good
```

This cop affects `6` files.

#### Decision:
This cop will remain enabled. Considering the small amount of files this cop affects and that the correction is not too destructive, it should be safe to use the `rubocop` autocorrector tool for this rule.

## Style/PredicateName
#### Observations:
```ruby
# bad
def is_password?
  ...
end
# good
def password?
  ...
end
```
The use of this cop is debatable.

#### Decision:
This cop will be disabled for now. [FLAG]

## Style/IndentationConsistency
#### Observations:
Ensures indents are lined up

#### Decision:
This cop will remain enabled. The autocorrector should be safe to use.

## Style/AlignParameters
#### Observations:
Ensures multi-line parameters of a method call are lined up. For example,
```ruby
# bad
has_many  :favorite_benches,
  through: :favorites,
  source: :bench
# good
has_many  :favorite_benches,
          through: :favorites,
          source: :bench
```
This cop affects `6` files.

#### Decision:
This cop will remain enabled. The autocorrector should be safe to use.
